rule tellyouthepass_log4j {
	meta:
		author = "Joshua Erickson"
		description = "Detects a log4j ransomeware sample"
		date = "2/16/23"
		reference = "https://bazaar.abuse.ch/sample/8abaa521a014cdbda2afe77042f21947b147197d274bf801de2df55b1e01c904/"
		reference2 = "https://bazaar.abuse.ch/sample/76960749ed11d97582923e31d59115910ae74d8753c8e92f918f604ca8a0d26d/"
		md5 = "0a34b668102bc070e8cb1d1fc1b0b462"
		md52 = "c88b15226ff88040d226d64b375ac12e"
	strings:
		$a = " !\"#$%&'()*+,-./0123456789:;<=>?@abcdefghijklmnopqrstuvwxyz[\\]^_`ABCDEFGHIJ" wide 
		$b = "  ignore_dir:"
		$c = "send_host: "
		$d = " !\"#$%%&&''((()))*++,,,,,------....//////0001123333333333444444444455666677777888888888889999999999::::::;;;;;;;;;;;;;;;;<<<<<<<<<<<<<<<<=====>>>>>>>>>>>??????????@@@@@@@@@@@@@@@@@@@@@@AAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"
	condition:
		all of them
}

rule tunnel_vision_log4j {
        meta:
                author = "Joshua Erickson"
                description = "Detects a log4j sample"
                date = "2/21/23"
                reference1 = "https://bazaar.abuse.ch/sample/c40923c35aed9830a3c295894663cb8bfd331640f5593f0d4da729accb22c4bb/"
		reference2 = "https://bazaar.abuse.ch/sample/7f680efadef8c0b3a192b2814077b7b5d8543d20dd24b1d8939f3fec013059a3/"
		reference3 = "https://bazaar.abuse.ch/sample/460b096aaf535b0b8f0224da0f04c7f7997c62bf715839a8012c1e1154a38984/"
		reference4 = "https://bazaar.abuse.ch/sample/4d15aa5d68b0e8b081c18d0ee5c06cc1758d17246a8d01b3c8ac48d1ef07610b/"
		reference5 = "https://bazaar.abuse.ch/sample/5c8710638fad8eeac382b0323461892a3e1a8865da3625403769a4378622077e/"
                md51 = "69b2ab3369823032991d4b306a170425"
		md52 = "6a2c91abf2b805365c847709215375af"
		md53 = "b99c4684f7eac1f2af37e6de609e936c"
		md54 = "c05f8b395c6356bf99aad9c84c13a867"
		md55 = "39a9b92a69a191db0a7e2bc1e78d55e4"
        strings:
                $a = "$79ea2e30-f4d2-41ef-a306-a6ef26b2f644"
		$b = "BzACAALQBBAGQAZAByAGUAc#BzAEYAYQB*AGkA^AB5ACAASQBQAHYANAApAC4ASQBQAEEAZABkAHIAZQBzAHMAW#A#AF0AO#ANAA?AJABjACAAPQAgACIAd#B?AG8AYQB*AGkAIgANAA?AJABjACAAPQAgACcAV#ByAGkAdABlAC0ASABvAHMAdAAgACIAIAAiAD@AJ#ArACQAY#ANAA?AJAByACAAPQAgACYAKABnAGMA^QAgAC?A$#BlAC0AZQAqACkAIAAkAGMAIAB8ACAAT#B1AHQALQBTAHQAcgBpAG4AZ#AgAD4AIAAiAGMAOgBcAHAAcgBvAGcAcgBhAG0AZABhAHQAYQBcACQAZQBuAHYAOgBDAE8ATQBQAFUAVABFAFIATgBBAE0ARQA*ACQA^ABpACIADQAKACQAdQByACAAPQAgACQAd#BjAC4AVQB#AG#A^#BhAGQARgBpAG#AZQA?ACIAJAB1AC8AcAB?AHAAcABvAHMAdAAuAHAA$AB#ACIAIAA@ACAAIgBjAD?AXAB#AHIA^#BnAHIAYQB*AGQAYQB0AGEAXAAkAGUA^gB2AD?AQ#BPAE0AUABVAFQARQBSAE4AQQBNAEUALQAkAG#A$QAiACkADQAKAHcA$ABpAG#AZQA?ACQAdAByAHUAZQApAA0ACgB7AA0ACgAgACAAIAAgACQAY#AgAD0AIAAkAHcAY#AuAEQA^#B3AG4A^ABvAGEAZABTAHQAcgBpAG4AZ#A?ACIAJAB1AC8AJABlAG4AdgA6AEMAT#BNAFAAVQBUAEUAUgBOAEEATQBFAC0AJAB@AGkAL#AxADIAM#AuAHQA-AB0ACIAKQANAA?AIAAgACAAIAAkAGMAIAA9ACAAJ#BXAHIA$QB0AGUALQBIAG8Ac#B0ACAAIgAgACIAO#AnAC@AJABjAA0ACgAgACAAIAAgAGkAZgA?ACQAY#AgAC0A^gBlACAAJAB#ACkADQAKACAAIAAgACAA-#ANAA?AIAAgACAAIAAgACAAIAAgACQAcgAgAD0AIAA%ACgAZ#BjAG0AIAAqAG@AZQA*AGUAKgApACAAJABjACAAfAAgAE8AdQB0AC0AU#B0AHIA$QBuAGcAIAA+ACAAIgBjAD?AXAB#AHIA^#BnAHIAYQB*AGQAYQB0AGEAXAAkAGUA^gB2AD?AQ#BPAE0AUABVAFQARQBSAE4AQQBNAEUALQAkAG#A$QAiAA0ACgAgACAAIAAgACAAIAAgACAAJAB#ACAAPQAgACQAY#ANAA?AIAAgACAAIAAgACAAIAAgACQAdQByACAAPQAgACQAd#BjAC4AVQB#AG#A^#BhAGQARgBpAG#AZQA?ACIAJAB1AC8AcAB?AHAAcABvAHMAdAAuAHAA$AB#ACIAIAA@ACAAIgBjAD?AXAB#AHIA^#BnAHIAYQB*AGQAYQB0AGEAXAAkAGUA^gB2AD?AQ#BPAE0AUABVAFQARQBSAE4AQQBNAEUALQAkAG#A$QAiACkADQAKACAAIAAgACAAfQANAA?AIAAgACAAIABzAG#AZQBlAHAAIAAyAA0ACgB9AA~~" wide
		$c = "-QBzAHQAZQB*AC4ATgBlAHQALgBXAGUAYgBDAG#A$QBlAG4AdAANAA?AJAB@AGkAIAA9ACAAKABHAGUAdAA*AE4AZQB0AEkAUABBAGQAZAByAGUAc#" wide
		$d = "#B%AC8AZ#BhAGQAZgBUAHMANQA1AHMAZ#B?AHMAU#BTAFMAIgANAA?AJAB3AGMAIAA9ACAATgBlAHcALQBPAGIA$gBlAGMAdAAgAFMA" wide
		$e = "AHMAOgAvAC8Ad#B3AHcALgB*AGkAY#ByAG8Ac#BvAGYAdAA*AHUAcABkAGEAdABlAHMAZQByAHYAZQByAC4AY" wide
		$f = "JABjACAAPQAiACIADQAKACQAcAAgAD0AIgAiAA0ACgAkAHIAIAA9ACAAIgAiAA0ACgAkAHUAIAA9ACAAIgB?AHQAdAB#" wide
		$g = " ce- llehsrewop" wide
		$h = "InteropServices" wide
        condition:
                all of them
}

rule billgates_log4j {
        meta:
                author = "Joshua Erickson"
                description = "Detects a log4j sample with the Bill Gates tag"
                date = "2/22/23"
                reference1 = "https://bazaar.abuse.ch/sample/0f31b2b43e5a106965f948b8e525211929c3d4d7218c6ee09d28528ab70526a5/"
		reference2 = "https://bazaar.abuse.ch/sample/93baa3abd9795be2beaa8cacaeb26041882d4f1738ab70b9c703cc674a2117de/"
		reference3 = "https://bazaar.abuse.ch/sample/a4b278170b0cb798ec930938b5bd45bbf12370a1ccb31a2bee6b2c406d881df6/"
                md51 = "53d2174b2d59a5cacf008312ecc42edb"
		md52 = "4871e162df46eac32da7cab645032829"
		md53 = "c8ba8bcfd8f068a19b89f112e80a9e56"
        strings:
		$a = "jjjjjj" wide
		$b = "jjjj" wide
		$c = "QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQj"
		$d = "11CAttackBase"
		$e = "13CPacketAttack"
		$f = "11CUpdateBill"
		$g = "12CUpdateGates"
		$h = "chmod 0755 %s"
		$i = "88FD2FE8EF8D51263B037677FD30F25CBFEB57F759F711FB41956288A85E9655F54FCCD1ABAAE55CF8BFB033B8F30342EC9930E4DA755715E37BFDF38ACFCC52569DA683A2B3B87A5C571840486689B97D8E7660C3F644B1F7F00778DBDEDE4CFD0CBBB222FC42C8F8ECE125D09D98EC50E5CF8093CF81D9E4F67FBA1E6A90O963846C17933E3C078E1EC409C799C84741C04892CC25E69FED40664BC85B955BEE188A63C9A3909D187ADE7DB69A66F83878E56E2FDD7CD5866DC4AC41EFC7EE9785806DAC64C1953F6A22F99317337B9F0DF3E26C365A8075076FA258CE2F0D6AC63BD6783E2A27CEB2A2410BC80232BABE5FB2C015263E64E1BAE2369822F"
		$j = "681A1C1543072E0140491F162F0B55545C55775F55565E57745E5D545652705D5E55585F70585C5659577D5B09525450705B5F5E5457725A0B"
		$k = "0123456789ABCDEF"
		$l = "ln -s /etc/init.d/%s %s"
        condition:
                all of them
}

rule coinminer_log4j {
        meta:
                author = "Joshua Erickson"
                description = "Detects a log4j sample with the Coin Miner tag"
                date = "2/23/23"
                reference1 = "https://bazaar.abuse.ch/sample/bcf0d0f5a9d7cefdfc3080cabb0d5b68f427f48217b039cf0358a3ea957bb4e0/"
		reference2 = "https://bazaar.abuse.ch/sample/6f62ac0de2adab3e4a948b8b2e110857d71070cebef9d6cc4236f3f18e22c9fb/"
		reference3 = "https://bazaar.abuse.ch/sample/d7b998957afba18e7f9c27b67692f1b26073250a6cf4187ad578e21925d16018/"
		reference4 = "https://bazaar.abuse.ch/sample/e8b2a8d0c3444c53f143d0b4ba87c23dd1b58b03fd0a6b1bcd6e8358e57807f1/"
                md51 = "a6475b4e6402e4543132c2e9928ea289"
		md52 = "ab7560e5c8af4f453fa4d79f9704e45e"
		md53 = "90f9e1fdec81ccf508fc58f3d23156b5"
		md54 = "c717c47941c150f867ce6a62ed0d2d35"
        strings:
		$a = "*%*/*O*U*_*e*k*m*s*"
		$b = "D#D)D;D?DEDKDQDSD"
		$c = "(1(=(?(I(Q([(](a(g(u("
		$d = "91C1E1K1]1a1g1m1"
		$e = "%.-.3.7.9.?.W.[.o.y."
		$f = "5;5A5Q5e5o5q5w5{5}5"
		$g = "E4U4W4c4i4m4"
		$h = "#9%9)9/9=9A9M9[9k9y9}9"
		$i = "=!=-=3=7=?=C=o=s=u=y={="
        condition:
                all of them
}
