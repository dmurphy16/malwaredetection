rule globeimposter_ransomware {
	meta:
		author = "Joshua Erickson"
		description = "Detects an instance of the globeimposter ransomware"
		date = "3/1/23"
		reference1 = "https://bazaar.abuse.ch/sample/fd71b1ab3e3823ccd88c0f406c30c4386074c36e1c0432e13121550cd655098f/"
		reference2 = "https://bazaar.abuse.ch/sample/9d3f3db89e771a30c511f90be78c95fe7dbd991a7724b53c0c8e51cf77c1af39/"
		reference3 = "https://bazaar.abuse.ch/sample/63396a28b79a7eaa60c384bcb02699398cd3b2b0c14fe9cfaf52b2ffa57798cc/"
		reference4 = "https://bazaar.abuse.ch/sample/1532bba40b917d274d0b3dc2b27c5feacae985ba425f3cffcb5e963e20af5bcb/"
		reference5 = "https://bazaar.abuse.ch/sample/e6fae4d52ed5450e44b6c16ce80abf4e63cdc25d3e4fc4f55c220cc1b740c2f5/"
		reference6 = "https://bazaar.abuse.ch/sample/39f5b60188d49196e6c10271a084a755f9553190898438b15107cdb950a4bbde/"
		md51 = "5efa19dc204e46e8d8c57482f80e7a40"
		md52 = "79c507ab07f046310bacda76bffa0afb"
		md53 = "0af2e477464520e3599dc58deaef2741"
		md54 = "4a6a6b20f1cf998265b089feb5012ac7"
		md55 = "821883525833df75c30d68584716f6fd"
		md56 = "e4e439fc5ade188ba2c69367ba6731b6"
	strings:
		$u1 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce" wide
		$u2 = "ALLUSERSPROFILE" wide
		$a1 = "0123456789ABCDEF"
		$a2 = "SHA224"
		$a3 = "sha224WithRSAEncryption"
		$a4 = "RSA with SHA-224"
		$a5 = "id-sha224"
		$a6 = "SHA-224"
		$a7 = "SHA256"	
		$a8 = "sha256WithRSAEncryption"	
		$a9 = "RSA with SHA-256"	
		$a10 = "id-sha256"	
		$a11 = "SHA-256"	
	condition:
		all of them
}

rule chaos_ransomware {
	meta:
		author = "Joshua Erickson"
		description = "Detects an instance of the chaos ransomware"
		date = "3/6/23"
		reference1 = "https://bazaar.abuse.ch/sample/c15e2ffa84d30fa17e9c61c19cde98b22ac6e259ec16b68a9927bed13a0aec07/"
		reference2 = "https://bazaar.abuse.ch/sample/8e7b4b201a8972142b560c663e92b8808e08c23c7859c00190201b5d6e85b037/"
		reference3 = "https://bazaar.abuse.ch/sample/98e6fe0dfa72dfd322bfbddc7bdd6813f339fc3d88bccb2dbc2ed6cb487b90e4/"
		reference4 = "https://bazaar.abuse.ch/sample/b8a0caadf78b63714aa008164ba51694c2a33830cf1377d1b5a143317016254b/"
		reference5 = "https://bazaar.abuse.ch/sample/2169f4931cb7ddeffcb816a487491c0df2035162f3b6652352b42dbceaace7fd/"
		reference6 = "https://bazaar.abuse.ch/sample/d09b875ead838ec256b863b5e8e252d5bca9172b5479b00699ff31b4d745c92b/"
		md51 = "77bd76f4e4b9481432022ab3b10c89c0"
		md52 = "078c6bd7d00a5659627cc3705877bb5b"
		md53 = "71c3a6f87a5c67593fd199a0fbc146bf"
		md54 = "825ed45d7ece9ce8c2e0222225096a32"
		md55 = "3330316c5956f83f0009d68cb63c636d"
		md56 = "98274f8ae42ac490c3441b3b14459356"
	strings:
		$u1 = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890*!=&?&/" wide
		$u2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$u3 = "vssadmin delete shadows /all /quiet & wmic shadowcopy delete" wide
		$u4 = "bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no" wide
		$u5 = "wbadmin delete catalog -quiet" wide
		$a1 = "userName"
		$a2 = "userDir"
		$a3 = "encryptionAesRsa"
		$a4 = "checkAdminPrivilage"
		$a5 = "checkdeleteShadowCopies"
		$a6  = "checkdisableRecoveryMode"
		$a7 = "checkdeleteBackupCatalog"
		$a8 = "deleteShadowCopies"
		$a9 = "disableRecoveryMode"
		$a10 = "deleteBackupCatalog"
		$a11 = "SetWallpaper"
		$a12 = "<encryptDirectory>b__2"
		$a13 = /\$\$method0x600000(e|f)-1/ 
	condition:
		all of them
}

rule phobos_ransomware {
	meta:
		author = "Joshua Erickson"
		description = "Detects an instance of the phobos ransomware"
		date = "3/6/23"
		reference1 = "https://bazaar.abuse.ch/sample/34c1121937c35b39b654428cf3fc6b16e3e2eed03c1ccbcfc77183d1749ebadc/"
		reference2 = "https://bazaar.abuse.ch/sample/0c0c9a19db1f89d94ddcd8af54fa631798e3ccc82743faae6d9818759f2dbcc1/"
		reference3 = "https://bazaar.abuse.ch/sample/4ae6519e0d6a7aaf9b684497763257e3a752ef0b31b4ba31afb9aecd1af59d9a/"
		reference4 = "https://bazaar.abuse.ch/sample/f4db61bb14a7af406c9cfc33075c6f74ab711bedf1e1fd6edc4f524bd304c1b6/"
		reference5 = "https://bazaar.abuse.ch/sample/265d1ae339e9397976d9328b2c84aca61a7cb6c0bca9f2f8dc213678e2b2ad86/"
		reference6 = "https://bazaar.abuse.ch/sample/8710ad8fb2938326655335455987aa17961b2496a345a7ed9f4bbfcb278212bc/"
		md51 = "25a54e24e9126fba91ccb92143136e9f"
		md52 = "8881f3e50b9f1bcb315769e24b76a3cc"
		md53 = "c5d5171d5af7b55de4056c8ef928b6d2"
		md54 = "25e0c92a4e1d058d5a04089efe63b290"
		md55 = "2d49e774bcace56a1a9717b745d3bce6"
		md56 = "ab7b66ee5385cb473b9c15db3e239692"
	strings:
		$u1 = "0123456789ABCDEF" wide
		$u2 = "ELVL" wide
		$u3 = "\\\\?\\X:" wide
		$a1 = "ShellExecuteExW"
		$a2 = "SHELL32.dll"
		$a3 = "InitializeCriticalSectionAndSpinCount"
		$a4 = "LeaveCriticalSection"
		$a5 = "EnterCriticalSection"
		$a6 = "DeleteCriticalSection"
		$a7 = "InitializeCriticalSectionAndSpinCount"
		$a8 = "LeaveCriticalSection"
		$a9 = "EnterCriticalSection"
		$a10 = "DeleteCriticalSection"
	condition:
		all of them
}
