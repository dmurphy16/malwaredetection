
rule log4j_billgates {
    meta:
        description = "Log4j - BillGates variant"
        sha1 = "0f31b2b43e5a106965f948b8e525211929c3d4d7218c6ee09d28528ab70526a5"
        sha1 = "93baa3abd9795be2beaa8cacaeb26041882d4f1738ab70b9c703cc674a2117de"
        sha1 = "a4b278170b0cb798ec930938b5bd45bbf12370a1ccb31a2bee6b2c406d881df6"
        author = "Deirdre Murphy"

    strings:
        $u1 = "QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQj"
        $u2 = "88FD2FE8EF8D51263B037677FD30F25CBFEB57F759F711FB41956288A85E9655F54FCCD1ABAAE55CF8BFB033B8F30342EC9930E4DA755715E37BFDF38ACFCC52569DA683A2B3B87A5C571840486689B97D8E7660C3F644B1F7F00778DBDEDE4CFD0CBBB222FC42C8F8ECE125D09D98EC50E5CF8093CF81D9E4F67FBA1E6A90O963846C17933E3C078E1EC409C799C84741C04892CC25E69FED40664BC85B955BEE188A63C9A3909D187ADE7DB69A66F83878E56E2FDD7CD5866DC4AC41EFC7EE9785806DAC64C1953F6A22F99317337B9F0DF3E26C365A8075076FA258CE2F0D6AC63BD6783E2A27CEB2A2410BC80232BABE5FB2C015263E64E1BAE2369822F"
        $u3 = "681A1C1543072E0140491F162F0B55545C55775F55565E57745E5D545652705D5E55585F70585C5659577D5B09525450705B5F5E5457725A0B"

        $s3 = "11CBillStatus"
        $s4 = "11CUpdateBill"

        $useragent1 = "Mozilla/5.0 (|S|) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/|D&23&25|.|D&0&9|.|D&1000&9000|.|D&10&99| Safari/537.17"
        $useragent2 = "Mozilla/5.0 (|S|; rv:18.0) Gecko/20100101 Firefox/18.0"
        $useragent3 = "Opera/|D&7&9|.|D&70&90| (|S|) Presto/2.|D&8&18|.|D&90&890| Version/|D&11&12|.|D&10&19|"

        $redhatv1 = "GCC: (GNU) 4.0.0 20050519 (Red Hat 4.0.0-8)"
        $redhatv2 = "GCC: (GNU) 4.0.0 20050525 (Red Hat 4.0.0-9)"

    condition:
        all of ($u*) and all of ($s*) and 1 of ($useragent*) and 1 of ($redhat*)
}
