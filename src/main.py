#!/usr/bin/env python3

import yara
import argparse
from pathlib import Path
import os


def compile_rules(dir_source) -> yara.Rules:
    pass

def main():
    parser = argparse.ArgumentParser(description="Scans a file or folder for malware")
    parser.add_argument("file", metavar="input", type=str, help="the file to scan")  # todo: take in directories
    args = parser.parse_args()
    path = args.file

    print("Starting malware scanner")

    rules = yara.compile(filepath="../rules/dummy_rule.yar")
    # rules = compile_rules("../rules")
    print("Compiled rules")

    matches = rules.match(path)
    print("Scan complete")

    print(matches)


if __name__ == "__main__":
    main()
